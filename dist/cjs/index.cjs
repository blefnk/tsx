"use strict";var S=require("path"),j=require("fs"),E=require("module"),i=require("get-tsconfig"),O=require("../source-map.cjs"),u=require("../index-5ae6ac30.cjs"),M=require("../resolve-ts-path-43f50656.cjs");require("source-map-support"),require("../node-features-72f7f76d.cjs"),require("url"),require("esbuild"),require("crypto"),require("os");function d(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var m=d(S),P=d(j),l=d(E);const b=/\b(?:import|export)\b/,q=s=>{if(b.test(s)){const[e,n]=u.parseEsm(s);return e.length>0||n.length>0}return!1},A=/^\.{1,2}\//,N=/\.[cm]?tsx?$/,R=`${m.default.sep}node_modules${m.default.sep}`,f=process.env.TSX_TSCONFIG_PATH?{path:m.default.resolve(process.env.TSX_TSCONFIG_PATH),config:i.parseTsconfig(process.env.TSX_TSCONFIG_PATH)}:i.getTsconfig(),h=f&&i.createFilesMatcher(f),x=f&&i.createPathsMatcher(f),y=O.installSourceMapSupport(),v=l.default._extensions,D=v[".js"],I=[".cts",".mts",".ts",".tsx",".jsx"],C=[".js",".cjs",".mjs"],F=(s,e)=>{process.send&&process.send({type:"dependency",path:e});const n=I.some(t=>e.endsWith(t)),o=C.some(t=>e.endsWith(t));if(!n&&!o)return D(s,e);let r=P.default.readFileSync(e,"utf8");if(e.endsWith(".cjs")){const t=u.transformDynamicImport(e,r);t&&(r=y(t,e))}else if(n||q(r)){const t=u.transformSync(r,e,{tsconfigRaw:h==null?void 0:h(e)});r=y(t,e)}s._compile(r,e)};[".js",".ts",".tsx",".jsx"].forEach(s=>{v[s]=F}),Object.defineProperty(v,".mjs",{value:F,enumerable:!1});const _=l.default._resolveFilename.bind(l.default);l.default._resolveFilename=(s,e,n,o)=>{var r;const t=s.indexOf("?");if(t!==-1&&(s=s.slice(0,t)),x&&!A.test(s)&&!((r=e==null?void 0:e.filename)!=null&&r.includes(R))){const a=x(s);for(const p of a){const T=g(p,e,n,o);if(T)return T;try{return _(p,e,n,o)}catch{}}}const c=g(s,e,n,o);return c||_(s,e,n,o)};const g=(s,e,n,o)=>{const r=M.resolveTsPath(s);if(e!=null&&e.filename&&N.test(e.filename)&&r)for(const t of r)try{return _(t,e,n,o)}catch(c){const{code:a}=c;if(a!=="MODULE_NOT_FOUND"&&a!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw c}};
